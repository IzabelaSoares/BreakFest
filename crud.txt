create database breakfest;

create table pessoafisica(
	idfisica serial not null,
    nome varchar(30) not null,
    sobrenome varchar(30) not null,
    cpf varchar(14) not null unique,
    datanascimento date not null,
    email varchar(30) not null unique,
    celular varchar(14) not null,
    cep varchar(9) not null, 
    estado varchar(30) not null,
    cidade varchar(30) not null,
    bairro varchar(30) not null,
    rua varchar(30) not null,
    numero integer not null,
    complemento varchar(80),
    primary key (idfisica)
);

create table pessoajuridica(
	idjuridica serial not null,
    razaosocial varchar(30) not null,
    nomefantasia varchar(30) not null,
    cnpj varchar(20) not null unique,
    email varchar(30) not null,
    telefone varchar(14) not null,
    cep varchar(9) not null, 
    estado varchar(30) not null,
    cidade varchar(30) not null,
    bairro varchar(30) not null,
    rua varchar(30) not null,
    numero integer not null,
    complemento varchar(80),
    imagem BYTEA,
    sobrepadaria varchar(2000) not null,
    instagram varchar(30),
    facebook varchar(30),
    primary key (idjuridica)
);

create table categoria (
	idcategoria serial not null,
	titulocategoria varchar(30),
	primary key (idcategoria)
);

create table produto (
	idproduto serial not null,
    titulo varchar(30) not null,
    imagem BYTEA,
    fkidcategoria integer not null,
    fkcnpj varchar(20) not null,
    descricao varchar(100) not null,
    preco real not null,
    tamanho varchar(30) not null,
    unidadedemedida varchar(15) not null,
    peso real not null,
    primary key  (idproduto),
    foreign key (fkidcategoria) references categoria(idcategoria),
    foreign key (fkcnpj) references pessoajuridica(cnpj)
);


create table pedido(
	idpedido serial not null,
	fkcpf varchar(14) not null,
    fkcnpj varchar(20) not null,
    fkidproduto integer not null,
    observacao varchar(300),
    datapedido timestamp, 
    primary key  (idpedido),
    foreign key (fkcpf) references pessoafisica(cpf),
    foreign key (fkcnpj) references pessoajuridica(cnpj),
    foreign key (fkidproduto) references produto(idproduto)
);

create table usuariofisico (
	idusuario serial not null,
	fkemail varchar(30) not null unique,
	senha varchar(20) not null,
	primary key (idusuario),
	foreign key (fkemail) references pessoafisica(email)
);
